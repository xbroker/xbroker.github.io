(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,n){e.exports=n(216)},126:function(e,t,n){},128:function(e,t,n){},130:function(e,t,n){},132:function(e,t,n){},134:function(e,t,n){},138:function(e,t,n){},140:function(e,t,n){},153:function(e,t,n){},210:function(e,t,n){},214:function(e,t,n){},216:function(e,t,n){"use strict";n.r(t);var a,c,r,o,l=n(0),i=n.n(l),s=n(8),u=n.n(s),m=n(14),d=n(48),h=n(94),v={},b=n(12),p={home:{type:"schema",schema:v},connections:{type:"schema",schema:{connectionId:{type:"value",persistent:!0,initValue:1},connections:{type:"collection",persistent:!0},connectionsCnt:{type:"view",sourceName:"connections",props:[],recipe:function(e,t){return Object(b.Seq)({cnt:e.count()})}},openConnections:{type:"view",sourceName:"connections",props:[],recipe:function(e,t){return e.filter(function(e){return"open"===e.get("state")})}}}},agents:{type:"schema",schema:{connectionAgents:{type:"collection",persistent:!1},connectionAgentsCnt:{type:"view",sourceName:"connectionAgents",props:[],recipe:function(e,t){return Object(b.Seq)({cnt:e.count()})}}}},commands:{type:"schema",schema:{connectionName:{type:"value",persistent:!0,initValue:""},agentName:{type:"value",persistent:!0,initValue:""},command:{type:"value",initValue:""},result:{type:"value",initValue:{}}}}};setInterval(function(){try{if(a===r&&c===o)return;var e=g.liveState(o),t=g.persistableState(e),n=JSON.stringify(t);localStorage.setItem(r,n),a=r,c=o}catch(l){console.log("DUXEN ERROR: persistState: ",l)}},1e3);var g=Object(h.createEngine)(p),f=(g.actionFactory(),function(e){var t="xbroker-manager:0.0.25",n=e.repoReducer(),a=Object(d.b)(n),c=function(e){try{var t=localStorage.getItem(e);if(null===t)return;var n=JSON.parse(t);return Object(b.fromJS)(n)}catch(a){return}}(t);return c&&a.dispatch(e.actionFactory().init(c)),a.dispatch(e.actionFactory().refresh()),a.subscribe(function(){return function(e,t){r=e,o=t}(t,a.getState())}),a}(g)),E=function(e){return f.dispatch(e)},y=function(){return g.head(f.getState())},C=(n(126),n(17)),k=n(18),S=n(20),O=n(19),j=n(21),B=(n(128),n(24)),w=(n(130),function(e){var t=window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/";return i.a.createElement("div",null,i.a.createElement("h2",null,"Home"),i.a.createElement("h3",null,i.a.createElement("a",{href:t},t)))}),A=g.subEngine("home"),N=Object(m.b)(function(e,t){return A.head(e),{}},function(e,t){return{}})(w),I=n(15),x=(n(132),function(e){var t,n=e.addConnection;return i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t&&t.value.trim()&&(n(Object(b.fromJS)({url:t.value,state:"created",message:""})),t.value="")}},i.a.createElement("input",{className:"AddConnection-input",ref:function(e){t=e}}),i.a.createElement("button",{className:"AddConnection-input",type:"submit"},i.a.createElement(I.a,{icon:"plus"})))}),F=(n(134),function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(k.a)(t,[{key:"removeConnection",value:function(e){this.props.removeConnection(e)}},{key:"renderStateIcon",value:function(e){var t;switch(e){case"open":t=i.a.createElement(I.a,{color:"blue",icon:"wifi",title:"Open"});break;default:t=i.a.createElement(I.a,{color:"red",icon:"exclamation-triangle",title:"Remove"})}return t}},{key:"renderConnections",value:function(e){var t=this;if(!e)return null;return i.a.createElement("div",null,i.a.createElement("table",{className:"minimalistBlack"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Name"),i.a.createElement("th",null,"URL"),i.a.createElement("th",null,"Status"),i.a.createElement("th",null,"Delete"))),i.a.createElement("tbody",null,e.map(function(e,n){var a=e.get("state");return i.a.createElement("tr",{key:n},i.a.createElement("td",null,n),i.a.createElement("td",null,i.a.createElement("b",null,e.get("url"),i.a.createElement("br",null),e.get("message"))),i.a.createElement("td",{className:"center"},i.a.createElement("button",null,t.renderStateIcon(a))),i.a.createElement("td",{className:"center"},i.a.createElement("button",{onClick:t.removeConnection.bind(t,n)},i.a.createElement(I.a,{icon:"trash-alt",title:"Remove"}))))}).toIndexedSeq())))}},{key:"render",value:function(){var e=this.props,t=e.connections,n=e.connectionsCnt,a=e.addConnection;return i.a.createElement("div",null,i.a.createElement("header",null,i.a.createElement("h2",null,"Connections (",n.get("cnt"),")")),i.a.createElement(x,{addConnection:a}),i.a.createElement("br",null),i.a.createElement("div",null,this.renderConnections(t)))}}]),t}(l.Component)),R=n(95),T=(n(138),function(e){return i.a.createElement("div",null,i.a.createElement("h2",null,"Agents"),(t=e.connectionAgents,t?t.map(function(e,t){return i.a.createElement("div",{key:t},i.a.createElement("h3",null,t," (",i.a.createElement("a",{href:e.get("url")},e.get("url")),")"),i.a.createElement("table",{className:"minimalistBlack"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Agent"),i.a.createElement("th",null,"Type"))),i.a.createElement("tbody",null,e.get("result").map(function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,i.a.createElement("b",null,t)),i.a.createElement("td",null,e))}).toIndexedSeq())))}).toIndexedSeq():null));var t}),J=g.subEngine("agents"),q=J.actionFactory(),D=(Object(m.b)(function(e,t){return n=J.head(e),{connectionAgents:J.get(n,"connectionAgents"),connectionsAgentsCnt:J.get(n,"connectionAgentsCnt")};var n},function(e,t){return{}})(T),g.subEngine("connections")),L=D.actionFactory(),M={},G=function(){D.get(y(),"connections").forEach(function(e){var t=e.get("id");if(!M[t]){var n={changeState:function(e){if(M[t]){var n,a,c=L.update("connections",t,{$set:{state:e}});E(c),"open"===e&&(n=t,(a=M[t]).submitAsync({agent:"",cmd:"list",args:["agents"]}).then(function(e){e.url=a.url;var t=q.insert("connectionAgents",n,e);E(t)}).catch(function(e){var t=q.insert("connectionAgents",n,e);E(t)}))}},setMessage:function(e){if(M[t]){var n=L.update("connections",t,{$set:{message:e}});E(n)}}},a=e.get("url");M[t]=Object(R.createClient)(a,n)}})};G();var V=Object(m.b)(function(e,t){return n=D.head(e),{connections:D.get(n,"connections"),connectionsCnt:D.get(n,"connectionsCnt")};var n},function(e,t){return{addConnection:function(t){var n=D.get(y(),"connectionId"),a="conn"+n;t=t.set("id",a);var c=L.value("connectionId",n+1),r=L.insert("connections",a,t),o=L.batch([c,r]);e(o),G()},removeConnection:function(t){var n=M[t];n&&(delete M[t],n.close(),function(e){var t=q.remove("connectionAgents",e);E(t)}(t));var a=L.remove("connections",t);e(a)}}})(F),z=n(32),W=n(71),$=(n(140),function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(S.a)(this,Object(O.a)(t).call(this,e))).state={command:""},n.handleChange=n.handleChange.bind(Object(z.a)(Object(z.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(z.a)(Object(z.a)(n))),n}return Object(j.a)(t,e),Object(k.a)(t,[{key:"handleChange",value:function(e){this.setState({command:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.submitCommand(this.state.command)}},{key:"render",value:function(){var e=this.props;return i.a.createElement("div",null,i.a.createElement("h2",null,"Commands"),i.a.createElement("label",null,"Connection:"),function(e,t,n){for(var a=function(e){return e.map(function(e,t){return{value:t,label:t+" ("+e.get("url")+")"}}).toIndexedSeq()}(t).toArray(),c=null,r=0;r<a.length;r++)if(a[r].value===e){c=a[r];break}return i.a.createElement(W.a,{name:"Connections",className:"Commands-select",value:c,options:a,onChange:n})}(e.state.get("connectionName"),e.connections,e.selectConnection),i.a.createElement("label",null,"Agent:"),function(e,t,n){if(!e)return null;for(var a=function(e){return e.map(function(e,t){return{value:t,label:t+" ("+e+")"}}).toIndexedSeq()}(e).toArray(),c=null,r=0;r<a.length;r++)if(a[r].value===t){c=a[r];break}return i.a.createElement(W.a,{name:"Agents",className:"Commands-select",value:c,options:a,onChange:n})}(e.agents.getIn([e.state.get("connectionName"),"result"]),e.state.get("agentName"),e.selectAgent),i.a.createElement("br",null),i.a.createElement("label",null,"Command:"),i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("input",{className:"Commands-input",type:"text",size:"25",value:this.state.command,onChange:this.handleChange}),i.a.createElement("button",{className:"Commands-input",type:"submit"},i.a.createElement(I.a,{icon:"running"}))),i.a.createElement("br",null),i.a.createElement("label",null,"Sent:"),i.a.createElement("div",null,JSON.stringify(e.state.get("command"))),i.a.createElement("label",null,"Received:"),i.a.createElement("div",null,JSON.stringify(e.state.get("result"))))}}]),t}(l.Component)),H=g.subEngine("connections"),P=g.subEngine("agents"),U=g.subEngine("commands"),X=U.actionFactory(),_=Object(m.b)(function(e,t){return n=U.head(e),{state:U.get(n),agents:P.get(n,"connectionAgents"),connections:H.get(n,"openConnections")};var n},function(e,t){return{selectConnection:function(t){return e(X.batch([X.value("connectionName",t.value),X.value("agentName","")]))},selectAgent:function(t){return e(X.value("agentName",t.value))},submitCommand:function(t){var n=t.trim().split(/\s+/),a=n.shift(),c=y(),r=U.get(c,"connectionName"),o=U.get(c,"agentName");try{var l=M[r];if(!l)throw new Error("Client Connection Does Not Exist: "+r);l.submitAsync({agent:o,cmd:a,args:n}).then(function(n){e(X.batch([X.value("command",t),X.value("result",n)]))}).catch(function(n){e(X.batch([X.value("command",t),X.value("result",U.message)]))})}catch(i){e(X.batch([X.value("command",t),X.value("result",i.message)]))}}}})($),K=n(50),Q=n.n(K),Y=n(99),Z=n.n(Y),ee=(n(153),function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(k.a)(t,[{key:"render",value:function(){var e=this.props,t=e.state,n=e.prevState,a=e.action,c=Object(b.fromJS)(a).toJS(),r=t.toJS(),o=Z()(n,t).toJS(),l="rjv-default";return i.a.createElement("div",null,i.a.createElement("header",null,i.a.createElement("h2",null,"State Inspector")),i.a.createElement("div",{className:"TimeMachinePage-body"},i.a.createElement(Q.a,{src:c,theme:l,name:"Action",collapsed:1}),i.a.createElement(Q.a,{src:r,theme:l,name:"State",collapsed:2,displayDataTypes:!1}),i.a.createElement(Q.a,{src:o,theme:l,name:"Diff",collapsed:2,displayDataTypes:!1})))}}]),t}(l.Component)),te=g,ne=Object(m.b)(function(e,t){var n=g.currentBranchState(e),a=n.get("currentIndex"),c=n.get("states"),r=a<0?void 0:c.get(a),o=n.get("actions"),l=a<0?void 0:o.get(a),i=a<=0?void 0:c.get(a-1);return{prevState:te.printableState(i),state:te.printableState(r),action:l}},function(e,t){return{}})(ee),ae=n(100),ce=n(105),re=(n(208),n(210),function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(S.a)(this,Object(O.a)(t).call(this,e))).state={currentBranch:e.currentBranch,live:e.live,advanced:!1,saveAs:""},n}return Object(j.a)(t,e),Object(k.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({currentBranch:e.currentBranch,live:e.live})}},{key:"onSubmit",value:function(e){e.preventDefault()}},{key:"onChange",value:function(e){this.setState(Object(ae.a)({},e.target.name,e.target.value))}},{key:"onChangeBranch",value:function(e){var t=this.props.switchBranch,n=e.target.value;this.setState({currentBranch:n}),t(n)}},{key:"onSaveBranch",value:function(e){var t=this.props.saveBranch;this.state.saveAs&&t(this.state.saveAs),this.setState({saveAs:""})}},{key:"onReset",value:function(e){var t=this.props,n=t.currentBranch;(0,t.resetBranch)(n)}},{key:"onRemove",value:function(e){var t=this.props,n=t.currentBranch;(0,t.removeBranch)(n)}},{key:"onGoFastForward",value:function(e){(0,this.props.goForward)(10)}},{key:"onGoForward",value:function(e){(0,this.props.goForward)(1)}},{key:"onGoBack",value:function(e){(0,this.props.goBack)(1)}},{key:"onGoFastBack",value:function(e){(0,this.props.goBack)(10)}},{key:"onGoLive",value:function(e){var t=this.props.goLive;this.setState({live:!1}),t()}},{key:"toggleLive",value:function(e){var t=this.props,n=t.goBack,a=t.goLive,c=!this.state.live;this.setState({live:c}),c?a():n(0)}},{key:"toggleAdvanced",value:function(e){var t=!this.state.advanced;this.setState({advanced:t})}},{key:"onSliderChange",value:function(e){var t=this.props,n=t.goForward,a=t.goBack,c=t.currentIndex,r=e-1;r>c?n(r-c):r<c&&a(c-r)}},{key:"render",value:function(){var e=this.props,t=e.branches,n=e.currentIndex,a=e.maxIndex;return i.a.createElement("div",null,i.a.createElement("form",{onSubmit:this.onSubmit.bind(this)},this.state.live?i.a.createElement(I.a,{icon:"play",title:"Time Machine On",onClick:this.toggleLive.bind(this)}):i.a.createElement(I.a,{icon:"stop",title:"Time Machine Off",onClick:this.toggleLive.bind(this)}),"\xa0",i.a.createElement("span",null,i.a.createElement("button",{onClick:this.toggleAdvanced.bind(this)},this.state.advanced?i.a.createElement("b",null,"\u2630"):i.a.createElement("span",null,"\u2630")),"\xa0",this.state.advanced?i.a.createElement("select",{name:"currentBranch",value:this.state.currentBranch,onChange:this.onChangeBranch.bind(this)},t.map(function(e,t){return i.a.createElement("option",{key:t,value:e},e)}).toIndexedSeq()):null,i.a.createElement("button",{onClick:this.onGoBack.bind(this)},"<"),"\xa0",n+1," / ",a+1,"\xa0",i.a.createElement("button",{onClick:this.onGoForward.bind(this)},">"),this.state.advanced?i.a.createElement("span",null,i.a.createElement("input",{name:"saveAs",size:"8",value:this.state.saveAs,onChange:this.onChange.bind(this)}),i.a.createElement("button",{onClick:this.onSaveBranch.bind(this),disabled:!this.state.saveAs},"Save"),i.a.createElement("button",{onClick:this.onReset.bind(this)},"Reset"),i.a.createElement("button",{onClick:this.onRemove.bind(this)},"Remove")):null)),this.state.live?null:i.a.createElement("div",{className:"TimeMachineControls-slider"},i.a.createElement(ce.a,{min:1,max:a+1,value:n+1,step:1,onChange:this.onSliderChange.bind(this)})))}}]),t}(l.Component)),oe=g.actionFactory(),le=Object(m.b)(function(e,t){var n=e.get("currentBranch"),a=e.get("branches"),c=a.get(n),r=c.get("live"),o=c.get("currentIndex"),l=c.get("states").size-1;return{branches:a.keySeq(),currentBranch:n,currentIndex:o,maxIndex:l,live:r}},function(e,t){return{goForward:function(t){var n=oe.goForward(t);e(n)},goBack:function(t){var n=oe.goBack(t);e(n)},goLive:function(){var t=oe.goLive();e(t)},switchBranch:function(t){var n=oe.switchBranch(t);e(n)},saveBranch:function(t){var n=oe.saveBranch(t);e(n)},resetBranch:function(t){var n=oe.resetBranch(t);e(n)},removeBranch:function(t){if("master"!==t){var n=oe.switchBranch("master");e(n);var a=oe.removeBranch(t);e(a)}}}})(re),ie=(n(212),n(214),function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(S.a)(this,Object(O.a)(t).call(this,e))).state={selectedTabIndex:0},n}return Object(j.a)(t,e),Object(k.a)(t,[{key:"updateTabIndex",value:function(e){this.setState({selectedTabIndex:e})}},{key:"render",value:function(){return i.a.createElement(B.d,{selectedTabClassName:"react-tabs__tab--selected Menu-selected",selectedIndex:this.state.selectedTabIndex,onSelect:this.updateTabIndex.bind(this)},i.a.createElement(B.b,{className:"Menu"},i.a.createElement(B.a,null,i.a.createElement(I.a,{icon:"home",title:"Home"})),i.a.createElement(B.a,null,i.a.createElement(I.a,{icon:"terminal",title:"Commands"})),i.a.createElement(B.a,null,i.a.createElement(I.a,{icon:"bug",title:"Debug"}))),i.a.createElement("hr",null),this.props.live?null:i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(le,null)),i.a.createElement(B.c,null,i.a.createElement(N,null),i.a.createElement(V,null)),i.a.createElement(B.c,null,i.a.createElement(_,null)),i.a.createElement(B.c,null,this.props.live?i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(le,null)):null,i.a.createElement(ne,null)))}}]),t}(l.Component)),se=n(5),ue=n(2),me=n(104);se.b.add(ue.B),se.b.add(ue.h),se.b.add(me.a),se.b.add(ue.i),se.b.add(ue.e),se.b.add(ue.w),se.b.add(ue.j),se.b.add(ue.u),se.b.add(ue.c),se.b.add(ue.t),se.b.add(ue.k),se.b.add(ue.l),se.b.add(ue.A),se.b.add(ue.n),se.b.add(ue.s),se.b.add(ue.y),se.b.add(ue.x),se.b.add(ue.z),se.b.add(ue.p),se.b.add(ue.q),se.b.add(ue.a),se.b.add(ue.m),se.b.add(ue.r),se.b.add(ue.d),se.b.add(ue.o),se.b.add(ue.v),se.b.add(ue.g),se.b.add(ue.f),se.b.add(ue.b);var de=function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(k.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"App-header"},i.a.createElement("span",{className:"App-title"},"X-Broker Manager")),i.a.createElement(ie,this.props))}}]),t}(l.Component),he=g,ve=Object(m.b)(function(e,t){return n=he.head(e),{live:he.live(e),state:n};var n},function(e,t){return{}})(de);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(i.a.createElement(m.a,{store:f},i.a.createElement(ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[107,2,1]]]);
//# sourceMappingURL=main.e7599581.chunk.js.map